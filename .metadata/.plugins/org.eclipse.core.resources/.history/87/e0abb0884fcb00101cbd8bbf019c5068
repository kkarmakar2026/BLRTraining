package com.mphasis;

import java.util.Arrays;
import java.util.Comparator;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;

/**
 * Demonstration of Java Streams API functionalities.
 * Covers terminal operations, intermediate operations,
 * filtering, mapping, reducing, sorting, and more.
 */
public class App {
    public static void main(String[] args) {

        // Sample Integer array
        Integer arr[] = {23, 12, 34, 34, 46, 67, 89, 26, 49, 14, 90};

        // ---------------- TERMINAL OPERATIONS ----------------

        // forEach: Print each element
        Arrays.stream(arr).forEach(System.out::println);

        // collect: Convert stream to List
        List<Integer> iList = Arrays.stream(arr).collect(Collectors.toList());
        System.out.println("List: " + iList);

        // min: Find minimum element using custom comparator
        int min = Arrays.stream(arr).min((a, b) -> a - b).get();
        System.out.println("Minimum (lambda): " + min);

        // min: Using Integer::compare
        min = Arrays.stream(arr).min(Integer::compare).get();
        System.out.println("Minimum (method ref): " + min);

        // count: Count number of elements
        long count = Arrays.stream(arr).count();
        System.out.println("Count: " + count);

        // reduce: Sum of array elements
        int sum = Arrays.stream(arr).reduce(0, (a, b) -> a + b);
        System.out.println("Sum of array elements: " + sum);

        // reduce: Find minimum using reduce
        System.out.println("Minimum using reduce: " +
                Arrays.stream(arr).reduce(Integer.MAX_VALUE, (a, b) -> a < b ? a : b));

        // ---------------- INTERMEDIATE OPERATIONS ----------------

        // 1. filter: Keep only even numbers
        System.out.println("Even numbers:");
        Stream.of(arr).filter(num -> num % 2 == 0).forEach(System.out::println);

        // 2. map: Add 10 to each number
        System.out.println("Numbers + 10:");
        Stream.of(arr).map(num -> num + 10).forEach(System.out::println);

        // 3. limit: Take first 5 elements
        System.out.println("First 5 elements:");
        Stream.of(arr).limit(5).forEach(System.out::println);

        // distinct: Count unique elements
        System.out.println("Distinct count: " + Arrays.stream(arr).distinct().count());

        // Print array as string
        System.out.println("Array: " + Arrays.toString(arr));

        // anyMatch: Check if any element > 25
        System.out.println("Any element > 25? " + Stream.of(arr).anyMatch(num -> num > 25));

        // findFirst: Find first element > 25
        System.out.println("First element > 25: " +
                Stream.of(arr).filter(num -> num > 25).findFirst().get());

        // ---------------- MORE STREAM OPERATIONS ----------------

        Integer[] nums = {23, 12, 45, 56, 29, 56, 15, 27, 43, 90, 76};
        List<Integer> numList = Arrays.asList(nums); // FIXED: must pass array

        // Filter numbers divisible by 3, remove duplicates, skip first 2, limit to 2
        System.out.println("Divisible by 3 (skip 2, limit 2):");
        numList.stream()
                .filter(num -> num % 3 == 0)
                .distinct()
                .skip(2)
                .limit(2)
                .forEach(System.out::println);

        // Sort ascending
        System.out.println("Sorted ascending:");
        numList.stream().sorted().forEach(System.out::println);

        // Sort descending
        System.out.println("Sorted descending:");
        numList.stream().sorted(Comparator.reverseOrder()).forEach(System.out::println);

        // ---------------- STREAM OF STRINGS ----------------

        String[] names = {"Koushik", "Ram", "Shamkill", "Naresh", "Ramesh", "Balai"};

        // Filter names with length >= 5 AND starting with 'S'
        System.out.println("Names with length >= 5 and starting with 'S':");
        Arrays.stream(names)
                .filter(name -> name.length() >= 5)
                .filter(name -> name.startsWith("S"))
                .forEach(System.out::println);
    }
}
